<html>
    <head>
        <title>Zenodeo: nodejs interface to Zenodo</title>
    
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="a time-space framework for sensors">
        <meta name="Copyright" content="CC0 Public Domain Dedication">
        <meta name="Author" content="Puneet Kishor">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
        <link rel="shortcut icon" href="/Skeleton-2.0.4/images/favicon.png">
        
        <link rel="stylesheet" href="/Skeleton-2.0.4/css/normalize.css">
        <link rel="stylesheet" href="/Skeleton-2.0.4/css/skeleton.min.css">
        <link rel="stylesheet" href="/highlight/styles/default.css">
        <link rel="stylesheet" href="/styles/styles.css">
    </head>

    <body class="container">
        <header class="row">
                
            <div id="title">Zenodo</div>
        
            <nav>
                <a href="/About">About</a> 
            </nav>
        </header>
                
{{{ content }}}

        <footer class="row">
            <p>Dedicated to the public domain under the CC0 Public Domain Dedication</p>
        </footer>
    
    <script src="/highlight/highlight.pack.js"></script>
    <script>
        var addClicker = function(link) {
            //var resultContainer = link.parentElement.children[2];
            link.addEventListener("click", function(event) {
                xhr(link);

                history.pushState(
                    "Zenodo: " + link.href.split("/").pop(),
                    null,
                    link.href
                );

                // see https://css-tricks.com/dangers-stopping-event-propagation/
                event.preventDefault();
                event.stopPropagation();
            });
        };

        var xhr = function(link) {
            var x = new XMLHttpRequest();

            x.onload = function(event) {
                if (x.readyState === 4) {
                    if (x.status === 200) {
                        var res = JSON.parse(x.responseText);
                        //console.log(res);
                        link.parentElement.children[2].innerHTML = JSON.stringify(res, undefined, 2);
                        hljs.highlightBlock(link.parentElement.children[2]);

                        event.preventDefault();
                        event.stopPropagation();
                        return false;
                    }
                }
            };

            x.onerror = function(e) {
                console.error(x.statusText);
            };

            x.open("GET", link, true);
            x.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
            x.send();
        };

	    var paths = document.getElementsByClassName('path');
        
        for (var i=0, j=paths.length; i<j; i++) {
            addClicker(paths[i]);
        }
    </script>
    </body>
</html>
